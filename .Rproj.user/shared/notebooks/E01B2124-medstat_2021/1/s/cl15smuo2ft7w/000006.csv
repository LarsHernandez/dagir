"0","# Number of drugs that compose n% of the expenses"
"0","me1 <- data %>% "
"0","  filter(sector==200) %>% "
"0","  group_by(atc_code, year) %>% "
"0","  summarize(tsum = sum(cost_adj, na.rm=T)) %>% "
"0","  group_by(year) %>% "
"0","  arrange(desc(tsum)) %>% "
"0","  mutate(csum = cumsum(tsum),"
"0","         pct  = csum/sum(tsum, na.rm=T),"
"0","         nn = row_number()) %>%"
"0","  group_by(year) %>% "
"0","  mutate(type = case_when(abs(pct-0.50) == min(abs(pct-0.50)) ~ ""50%"","
"0","                          abs(pct-0.25) == min(abs(pct-0.25)) ~ ""25%"","
"0","                          abs(pct-0.75) == min(abs(pct-0.75)) ~ ""75%"","
"0","                          abs(pct-0.85) == min(abs(pct-0.85)) ~ ""85%"""
"0","                          )) %>% "
"0","  filter(!is.na(type)) %>% "
"0","  ggplot(aes(year, nn, color=type)) + "
"0","  geom_line(size=1.5) + "
"0","  geom_point(size = 1, shape=21, stroke=2.5, fill=""white"") +"
"0","  scale_color_manual(values=palblue(5)[1:4]) +"
"0","  scale_x_continuous(breaks=c(seq(1997,2018, by=3))) +"
"0","  guides(color = guide_legend(reverse = TRUE)) +"
"0","  geom_text(aes(label=nn), nudge_y = 8, show.legend = F, size=3)+"
"0","  labs(title=NULL, y=""n"",x=NULL, "
"0","       caption = ""Source: Medstat"", color=""Percentage"") + theme_minimal() + "
"0","  theme(panel.grid.major.y = element_blank(), panel.grid.minor = element_blank())"
"0","me1"
